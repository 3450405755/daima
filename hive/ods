set hive.exec.mode.local.auto=true;

create database if not exists day0325;

use day0325;

drop table ods_page_log;
create table if not exists ods_page_log(
    line string
)comment '日志表'
    partitioned by (dt string)
row format delimited
fields terminated by "\t"
LOCATION '/2207A/gmall/ods/ods_page_log';
load data inpath '/flume/events/2025-03-25' into table ods_page_log partition (dt='2025-03-25');

select * from ods_page_log;

drop table ods_order_info;
create table if not exists ods_order_info(
    id bigint COMMENT '编号',
 consignee string COMMENT '收货人',
 consignee_tel string COMMENT '收件人电话',
 total_amount decimal(16,2) COMMENT '总金额',
 order_status string COMMENT '订单状态',
 user_id bigint COMMENT '用户id',
 payment_way string COMMENT '付款方式',
 delivery_address string COMMENT '送货地址',
 order_comment string COMMENT '订单备注',
 out_trade_no string COMMENT '订单交易编号（第三方支付用)',
 trade_body string COMMENT '订单描述(第三方支付用)',
 create_time string COMMENT '创建时间',
 operate_time string COMMENT '操作时间',
 expire_time string COMMENT '失效时间',
 process_status string COMMENT '进度状态',
 tracking_no string COMMENT '物流单编号',
 parent_order_id bigint COMMENT '父订单编号',
 img_url string COMMENT '图片路径',
 province_id int COMMENT '地区',
 activity_reduce_amount decimal(16,2) COMMENT '促销金额',
 coupon_reduce_amount decimal(16,2) COMMENT '优惠券',
 original_total_amount decimal(16,2) COMMENT '原价金额',
 feight_fee decimal(16,2) COMMENT '运费',
 feight_fee_reduce decimal(16,2) COMMENT '运费减免',
 refundable_time string COMMENT '可退款日期（签收后30天）'
    )partitioned by (dt string)
row format delimited
fields terminated by "\t"
location "/2207/gmall1/ods/ods_order_info";


drop table ods_order_detail;
create table if not exists ods_order_detail(
  id bigint COMMENT '编号',
 order_id bigint COMMENT '订单编号',
 sku_id bigint COMMENT 'sku_id',
 sku_name string COMMENT 'sku名称（冗余)',
 img_url string COMMENT '图片名称（冗余)',
 order_price decimal(16,2) COMMENT '购买价格(下单时sku价格）',
 sku_num string COMMENT '购买个数',
 create_time string COMMENT '创建时间',
 source_type string COMMENT '来源类型',
 source_id bigint COMMENT '来源编号',
 split_total_amount decimal(16,2),
 split_activity_amount decimal(16,2),
 split_coupon_amount decimal(16,2)
    )partitioned by (dt string)
row format delimited
fields terminated by "\t"
location "/2207/gmall1/ods/ods_order_detail";




drop table ods_sku_info;
create table if not exists ods_sku_info(
id bigint COMMENT '库存id(itemID)',
 spu_id bigint COMMENT '商品id',
 price decimal(16,2) COMMENT '价格',
 sku_name string COMMENT 'sku名称',
 sku_desc string COMMENT '商品规格描述',
 weight decimal(16,2) COMMENT '重量',
 tm_id bigint COMMENT '品牌(冗余)',
 category3_id bigint COMMENT '三级分类id（冗余)',
 sku_default_img string COMMENT '默认显示图片(冗余)',
 is_sale string COMMENT '是否销售（1：是 0：否）',
 create_time string COMMENT '创建时间'
    )partitioned by (dt string)
row format delimited
fields terminated by "\t"
location "/2207/gmall1/ods/ods_sku_info";


drop table ods_user_info;
create table if not exists ods_user_info(
id bigint COMMENT '编号',
 login_name string COMMENT '用户名称',
 nick_name string COMMENT '用户昵称',
 passwd string COMMENT '用户密码',
 name string COMMENT '用户姓名',
 phone_num string COMMENT '手机号',
 email string COMMENT '邮箱',
 head_img string COMMENT '头像',
 user_level string COMMENT '用户级别',
 birthday string COMMENT '用户生日',
 gender string COMMENT '性别 M男,F女',
 create_time string COMMENT '创建时间',
 operate_time string COMMENT '修改时间',
 status string COMMENT '状态'
    )partitioned by (dt string)
row format delimited
fields terminated by "\t"
location "/2207/gmall1/ods/ods_user_info";


load data inpath "/2207A/order_info/2025-03-25" into table ods_order_info partition (dt="2025-03-25");
load data inpath "/2207A/order_detail/2025-03-25" into table ods_order_detail partition (dt="2025-03-25");
load data inpath "/2207A/sku_info/2025-03-25" into table ods_sku_info partition (dt="2025-03-25");
load data inpath "/2207A/user_info/2025-03-25" into table ods_user_info partition (dt="2025-03-25");

select * from ods_order_info;
select * from ods_order_detail;
select * from ods_sku_info;
select * from ods_user_info;